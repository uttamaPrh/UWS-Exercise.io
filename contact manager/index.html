<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>📇 Contact Manager</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
    <style>
        :root {
            --primary: #0e850a;
            --accent: #ff6b6b;
            --bg: #f4f6fb;
            --white: #ffffff;
            --text-dark: #333;
            --border: #e0e4ea;
            --shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
            --radius: 12px;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg);
            color: var(--text-dark);
            margin: 0;
            padding: 0;
        }

        h1 {
            text-align: center;
            color: var(--primary);
            margin-top: 30px;
            font-size: 2rem;
        }

        .container {
            width: 100%;
            max-width: 1100px;
            margin: 40px auto;
            background: var(--white);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 25px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .add-btn {
            background-color: var(--primary);
            color: #fff;
            border: none;
            border-radius: var(--radius);
            padding: 10px 16px;
            font-size: 15px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .add-btn:hover {
            background-color: #3bd100;
        }

        #search {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            margin-bottom: 20px;
            font-size: 15px;
            box-sizing: border-box;
        }

        /* --- Contact Grid --- */
        .contact-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 20px;
        }

        .contact-card {
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            text-align: center;
            padding: 15px 10px;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
            transition: all 0.2s;
        }

        .contact-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow);
        }

        .contact-card img {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #e0e0e0;
            margin-bottom: 10px;
        }

        .contact-card h4 {
            margin: 0;
            font-size: 15px;
            font-weight: 600;
            color: var(--text-dark);
            word-wrap: break-word;
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: #888;
            display: none;
        }

        /* --- Pagination --- */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .pagination button {
            border: none;
            background: var(--primary);
            color: white;
            padding: 8px 14px;
            border-radius: var(--radius);
            cursor: pointer;
            transition: background 0.2s;
            font-size: 14px;
        }

        .pagination button:hover {
            background: #29b300;
        }

        .pagination button.disabled {
            background: #b8b8b8;
            cursor: not-allowed;
        }

        .pagination .active {
            background: #09700a;
            font-weight: bold;
        }

        /* --- Modals --- */
        .modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 15px;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .modal-content {
            background: var(--white);
            padding: 25px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            width: 100%;
            max-width: 400px;
            text-align: center;
            box-sizing: border-box;
        }

        .preview {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            object-fit: cover;
            margin-bottom: 10px;
            border: 2px solid var(--border);
        }

        input[type="file"],
        input[type="text"],
        input[type="email"] {
            width: 100%;
            padding: 10px;
            margin-bottom: 12px;
            border-radius: var(--radius);
            border: 1px solid var(--border);
            font-size: 15px;
            box-sizing: border-box;
        }

        .modal-actions {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .modal-actions button {
            padding: 10px 15px;
            border: none;
            border-radius: var(--radius);
            font-size: 14px;
            cursor: pointer;
            color: #fff;
        }

        .btn-cancel {
            background: #6c757d;
        }

        .btn-save {
            background: var(--primary);
        }

        .btn-delete {
            background: var(--accent);
        }

        .edit {
            background: #20c997;
        }

        .delete {
            background: var(--accent);
        }
    </style>
</head>

<body>
    <h1>📇 Contact Manager</h1>
    <div class="container">
        <div class="header">
            <h2>My Contacts</h2>
            <button class="add-btn" onclick="openAddModal()">+ Add Contact</button>
        </div>

        <input type="text" id="search" placeholder="🔍 Search contacts..." />

        <div id="contacts-grid" class="contact-grid"></div>
        <div class="empty-state" id="empty-default">
            <img src="./empty.webp" alt="No Contacts" width="120" />
            <p>No contacts available. Click "Add Contact" to create one!</p>
        </div>
        <div class="empty-state" id="empty-search">
            <img src="./empty.webp" alt="No Results" width="120" />
            <p>No contacts found matching your search.</p>
        </div>

        <div class="pagination" id="pagination"></div>
    </div>

    <!-- Add Modal -->
    <div class="modal" id="add-modal">
        <div class="modal-content">
            <h3>Add Contact</h3>
            <img id="add-preview" class="preview" src="https://cdn-icons-png.flaticon.com/512/847/847969.png"
                alt="Preview">
            <input type="file" id="add-image" accept="image/*" onchange="previewImage(this, 'add-preview')" />
            <input type="text" id="add-name" placeholder="Full Name" />
            <input type="text" id="add-phone" placeholder="Phone Number" />
            <input type="email" id="add-email" placeholder="Email Address" />
            <div class="modal-actions">
                <button class="btn-cancel" onclick="closeAddModal()">Cancel</button>
                <button class="btn-save" onclick="addContact()">Add</button>
            </div>
        </div>
    </div>

    <!-- View Modal -->
    <div class="modal" id="view-modal">
        <div class="modal-content">
            <h3>Contact Details</h3>
            <img id="view-avatar" class="preview" alt="Avatar">
            <div id="view-details"></div>
            <div class="modal-actions">
                <button class="edit" id="view-edit-btn">Edit</button>
                <button class="delete" id="view-delete-btn">Delete</button>
            </div>
            <div class="modal-actions">
                <button class="btn-cancel" onclick="closeViewModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Edit Modal -->
    <div class="modal" id="edit-modal">
        <div class="modal-content">
            <h3>Edit Contact</h3>
            <img id="edit-preview" class="preview" src="https://cdn-icons-png.flaticon.com/512/847/847969.png"
                alt="Preview">
            <input type="file" id="edit-image" accept="image/*" onchange="previewImage(this, 'edit-preview')" />
            <input type="text" id="edit-name" />
            <input type="text" id="edit-phone" />
            <input type="email" id="edit-email" />
            <div class="modal-actions">
                <button class="btn-cancel" onclick="closeEditModal()">Cancel</button>
                <button class="btn-save" onclick="saveEdit()">Save</button>
            </div>
        </div>
    </div>

    <!-- Delete Modal -->
    <div class="modal" id="delete-modal">
        <div class="modal-content">
            <h3>Delete Contact?</h3>
            <p>Are you sure you want to delete this contact?</p>
            <div class="modal-actions">
                <button class="btn-cancel" onclick="closeDeleteModal()">Cancel</button>
                <button class="btn-delete" onclick="confirmDelete()">Delete</button>
            </div>
        </div>
    </div>

    <script>
        const defaultAvatar = "https://cdn-icons-png.flaticon.com/512/847/847969.png";
        let contacts = JSON.parse(localStorage.getItem('contacts')) || [];
        let currentEditId = null;
        let deleteTargetId = null;
        let currentPage = 1;

        const isMobile = () => window.innerWidth <= 768;
        const perPage = () => (isMobile() ? 6 : 6);

        document.addEventListener('DOMContentLoaded', () => displayContacts());
        window.addEventListener('resize', () => displayContacts());
        document.getElementById('search').addEventListener('input', searchContacts);

        function previewImage(input, previewId) {
            const file = input.files[0];
            const preview = document.getElementById(previewId);
            if (file) {
                const reader = new FileReader();
                reader.onload = e => preview.src = e.target.result;
                reader.readAsDataURL(file);
            } else {
                preview.src = defaultAvatar;
            }
        }

        function paginate(list) {
            const start = (currentPage - 1) * perPage();
            const end = start + perPage();
            return list.slice(start, end);
        }

        function renderPagination(list) {
            const totalPages = Math.ceil(list.length / perPage());
            const pagination = document.getElementById('pagination');
            pagination.innerHTML = '';

            if (totalPages <= 1) return;

            const prevBtn = document.createElement('button');
            prevBtn.textContent = '⟨ Prev';
            prevBtn.disabled = currentPage === 1;
            prevBtn.className = currentPage === 1 ? 'disabled' : '';
            prevBtn.onclick = () => { currentPage--; displayContacts(list); };
            pagination.appendChild(prevBtn);

            for (let i = 1; i <= totalPages; i++) {
                const btn = document.createElement('button');
                btn.textContent = i;
                btn.className = i === currentPage ? 'active' : '';
                btn.onclick = () => { currentPage = i; displayContacts(list); };
                pagination.appendChild(btn);
            }

            const nextBtn = document.createElement('button');
            nextBtn.textContent = 'Next ⟩';
            nextBtn.disabled = currentPage === totalPages;
            nextBtn.className = currentPage === totalPages ? 'disabled' : '';
            nextBtn.onclick = () => { currentPage++; displayContacts(list); };
            pagination.appendChild(nextBtn);
        }

        function displayContacts(list = contacts, isSearch = false) {
            const grid = document.getElementById('contacts-grid');
            const emptyDefault = document.getElementById('empty-default');
            const emptySearch = document.getElementById('empty-search');
            grid.innerHTML = '';
            emptyDefault.style.display = 'none';
            emptySearch.style.display = 'none';

            if (list.length === 0) {
                (isSearch ? emptySearch : emptyDefault).style.display = 'block';
                document.getElementById('pagination').innerHTML = '';
                return;
            }

            const paginated = paginate(list);
            paginated.forEach(c => {
                const card = document.createElement('div');
                card.className = 'contact-card';
                card.innerHTML = `
          <img src="${c.image || defaultAvatar}" alt="${c.name}">
          <h4>${c.name}</h4>
        `;
                card.onclick = () => openViewModal(c.id);
                grid.appendChild(card);
            });

            renderPagination(list);
        }

        function openAddModal() {
            document.getElementById('add-modal').style.display = 'flex';
            document.getElementById('add-preview').src = defaultAvatar;
        }

        function closeAddModal() {
            document.getElementById('add-modal').style.display = 'none';
            document.getElementById('add-name').value = '';
            document.getElementById('add-phone').value = '';
            document.getElementById('add-email').value = '';
            document.getElementById('add-image').value = '';
        }

        function addContact() {
            const name = document.getElementById('add-name').value.trim();
            const phone = document.getElementById('add-phone').value.trim();
            const email = document.getElementById('add-email').value.trim();
            const image = document.getElementById('add-preview').src;
            if (!name || !phone || !email) return alert("Please fill all fields.");

            contacts.unshift({ id: Date.now(), name, phone, email, image });
            localStorage.setItem('contacts', JSON.stringify(contacts));
            closeAddModal();
            currentPage = 1;
            displayContacts();
        }

        function openViewModal(id) {
            const c = contacts.find(x => x.id === id);
            if (!c) return;
            document.getElementById('view-avatar').src = c.image || defaultAvatar;
            document.getElementById('view-details').innerHTML = `
        <p><strong>Name:</strong> ${c.name}</p>
        <p><strong>Phone:</strong> ${c.phone}</p>
        <p><strong>Email:</strong> ${c.email}</p>`;
            document.getElementById('view-modal').style.display = 'flex';
            document.getElementById('view-edit-btn').onclick = () => { closeViewModal(); openEditModal(id); };
            document.getElementById('view-delete-btn').onclick = () => { closeViewModal(); openDeleteModal(id); };
        }

        function closeViewModal() { document.getElementById('view-modal').style.display = 'none'; }

        function openEditModal(id) {
            currentEditId = id;
            const c = contacts.find(x => x.id === id);
            if (!c) return;
            document.getElementById('edit-name').value = c.name;
            document.getElementById('edit-phone').value = c.phone;
            document.getElementById('edit-email').value = c.email;
            document.getElementById('edit-preview').src = c.image || defaultAvatar;
            document.getElementById('edit-modal').style.display = 'flex';
        }

        function closeEditModal() { document.getElementById('edit-modal').style.display = 'none'; }

        function saveEdit() {
            const name = document.getElementById('edit-name').value.trim();
            const phone = document.getElementById('edit-phone').value.trim();
            const email = document.getElementById('edit-email').value.trim();
            const image = document.getElementById('edit-preview').src;
            if (!name || !phone || !email) return alert("Please fill all fields.");

            const i = contacts.findIndex(c => c.id === currentEditId);
            if (i !== -1) {
                contacts[i] = { ...contacts[i], name, phone, email, image };
                localStorage.setItem('contacts', JSON.stringify(contacts));
                closeEditModal();
                displayContacts();
            }
        }

        function openDeleteModal(id) {
            deleteTargetId = id;
            document.getElementById('delete-modal').style.display = 'flex';
        }

        function closeDeleteModal() { document.getElementById('delete-modal').style.display = 'none'; }

        function confirmDelete() {
            contacts = contacts.filter(c => c.id !== deleteTargetId);
            localStorage.setItem('contacts', JSON.stringify(contacts));
            closeDeleteModal();
            displayContacts();
        }

        function searchContacts() {
            const q = document.getElementById('search').value.toLowerCase();
            const filtered = contacts.filter(c => c.name.toLowerCase().includes(q));
            currentPage = 1;
            displayContacts(filtered, true);
        }

        window.addEventListener('click', (e) => {
            document.querySelectorAll('.modal').forEach(modal => {
                if (e.target === modal) modal.style.display = 'none';
            });
        });
    </script>
</body>

</html>